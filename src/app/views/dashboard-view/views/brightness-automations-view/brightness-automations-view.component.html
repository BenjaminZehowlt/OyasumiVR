<div class="pane">
  <div class="pane-title" translate>Brightness Automations</div>
  <div class="pane-content">
    <div class="setting-category">
      <p
      >Oyasumi can automatically adjust the brightness of your headset when sleep mode is enabled
        or disabled.</p
      >
      <div class="alert warning" @vshrink *ngIf="!brightnessControlAvailable">
        <div class="alert-bg"></div>
        <div class="alert-icon">
          <i class="material-icons"> warning </i>
        </div>
        <div class="alert-content">
          <span>{{
            'Display brightness control is currently only available on Valve Index. Please make sure SteamVR is running and your headset is connected.'
              | translate
            }}</span>
        </div>
      </div>
      <div class="settings">
        <div class="setting-row" [class.disabled]="!brightnessControlAvailable">
          <div class="setting-row-label" translate>
            <span>When I go to sleep</span>
            <span>Adjust my display brightness</span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="onSleepModeEnableConfig.enabled"
                (change)="
                  setAutomationEnabled(
                    'DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_ENABLE',
                    !onSleepModeEnableConfig.enabled
                  )
                "
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="setting-row-group">
          <div class="setting-row" [class.disabled]="!brightnessControlAvailable || !onSleepModeEnableConfig.enabled">
            <div class="setting-row-label" translate>
              <span>Change the brightness to</span>
              <span></span>
            </div>
            <div class="setting-row-action">
              <app-slider-setting
                unit="%"
                [min]="brightnessBounds.min"
                [max]="brightnessBounds.max"
                [value]="onSleepModeEnableConfig.brightness"
                (valueChange)="updateBrightness('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_ENABLE', $event)"
                [step]="1"
                [snapValues]="brightnessSnapValues"
                [snapDistance]="brightnessSnapDistance"
              ></app-slider-setting>
            </div>
          </div>

          <div class="setting-row" [class.disabled]="!brightnessControlAvailable || !onSleepModeEnableConfig.enabled">
            <div class="setting-row-label" translate>
              <span>Adjust brightness gradually</span>
              <span>Smoothly transition to your desired brightness value</span>
            </div>
            <div class="setting-row-action">
              <label class="switch-toggle">
                <input type="checkbox"
                       [checked]="onSleepModeEnableConfig.transition"
                       (change)="
                  toggleTransitioning(
                    'DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_ENABLE',
                    !onSleepModeEnableConfig.transition
                  )
                "
                />
                <span class="switch-toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-row"
               [class.disabled]="!brightnessControlAvailable || !onSleepModeEnableConfig.enabled || !onSleepModeEnableConfig.transition">
            <div class="setting-row-label" translate>
              <span>Transition time</span>
              <span>How long it should take to transition to the new brightness setting</span>
            </div>
            <div class="setting-row-action">
              <app-slider-setting
                [min]="1"
                [value]="transitionValueOnEnable"
                (valueChange)="onChangeTransition('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_ENABLE', $event, transitionUnitOptionOnEnable)"
                [snapValues]="[15, 30, 45]"
                [snapDistance]="5"
                [max]="59"
                [step]="1"
              ></app-slider-setting>
              <app-select-box
                class="status-dropdown"
                [type]="'SMALL'"
                [items]="transitionUnitOptions"
                [selected]="transitionUnitOptionOnEnable"
                (selectedChange)="onChangeTransition('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_ENABLE', transitionValueOnEnable, $event)"
                #transitionUnitOnEnable
              ></app-select-box>
            </div>
          </div>
        </div>
        <div class="setting-row" [class.disabled]="!brightnessControlAvailable">
          <div class="setting-row-label" translate>
            <span>When I wake up</span>
            <span>Adjust my display brightness</span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="onSleepModeDisableConfig.enabled"
                (change)="
                  setAutomationEnabled(
                    'DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_DISABLE',
                    !onSleepModeDisableConfig.enabled
                  )
                "
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="setting-row-group">
          <div class="setting-row" [class.disabled]="!brightnessControlAvailable || !onSleepModeDisableConfig.enabled">
            <div class="setting-row-label" translate>
              <span>Change the brightness to</span>
              <span></span>
            </div>
            <div class="setting-row-action">
              <app-slider-setting
                unit="%"
                [min]="brightnessBounds.min"
                [max]="brightnessBounds.max"
                [value]="onSleepModeDisableConfig.brightness"
                (valueChange)="updateBrightness('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_DISABLE', $event)"
                [step]="1"
                [snapValues]="brightnessSnapValues"
                [snapDistance]="brightnessSnapDistance"
              ></app-slider-setting>
            </div>
          </div>

          <div class="setting-row" [class.disabled]="!brightnessControlAvailable || !onSleepModeDisableConfig.enabled">
            <div class="setting-row-label" translate>
              <span>Adjust brightness gradually</span>
              <span>Smoothly transition to your desired brightness value</span>
            </div>
            <div class="setting-row-action">
              <label class="switch-toggle">
                <input type="checkbox"
                       [checked]="onSleepModeDisableConfig.transition"
                       (change)="
                  toggleTransitioning(
                    'DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_DISABLE',
                    !onSleepModeDisableConfig.transition
                  )
                " />
                <span class="switch-toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-row"
               [class.disabled]="!brightnessControlAvailable || !onSleepModeDisableConfig.enabled || !onSleepModeDisableConfig.transition">
            <div class="setting-row-label" translate>
              <span>Transition time</span>
              <span>How long it should take to transition to the new brightness setting</span>
            </div>
            <div class="setting-row-action">
              <app-slider-setting
                [min]="1"
                [snapValues]="[15, 30, 45]"
                [value]="transitionValueOnDisable"
                (valueChange)="onChangeTransition('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_DISABLE', $event, transitionUnitOptionOnDisable)"
                [snapDistance]="5"
                [max]="59"
                [step]="1"
              ></app-slider-setting>
              <app-select-box
                class="status-dropdown"
                [type]="'SMALL'"
                [items]="transitionUnitOptions"
                [selected]="transitionUnitOptionOnDisable"
                (selectedChange)="onChangeTransition('DISPLAY_BRIGHTNESS_ON_SLEEP_MODE_DISABLE', transitionValueOnDisable, $event)"
              ></app-select-box>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
